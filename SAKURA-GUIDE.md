# 动漫角色猜谜游戏 - 樱花内网穿透指南

本指南将帮助你使用樱花（SakuraFrp）内网穿透服务来部署动漫角色猜谜游戏，让你的朋友可以通过公网访问你的游戏。

## 准备工作

1. 注册并下载樱花内网穿透客户端 (SakuraFrp)
   - 官网: https://www.natfrp.com/
   - 下载链接: https://www.natfrp.com/tunnel/download

2. 充值并购买节点
   - 樱花需要付费使用，请先充值并购买适合你的节点

3. 确保已正确设置本地游戏服务

## 樱花穿透配置步骤

### 1. 创建穿透隧道

你需要创建两个隧道：

#### 前端隧道:
- 隧道类型: HTTP
- 本地IP: 127.0.0.1
- 本地端口: 5173
- 远程端口: 自定义（记住这个端口号）
- 节点: 选择离你较近的节点

#### 后端隧道:
- 隧道类型: TCP
- 本地IP: 127.0.0.1
- 本地端口: 3000
- 远程端口: 自定义（记住这个端口号）
- 节点: 与前端隧道相同的节点

> **注意**: 如果你想穿透数据服务器，还需要创建第三个隧道用于3001端口

### 2. 启动隧道

1. 在樱花内网穿透客户端中启动你创建的两个隧道
2. 确保状态显示为"已连接"

### 3. 使用start-sakura.bat启动游戏

1. 运行`start-sakura.bat`脚本
2. 输入樱花分配的域名（不含http://）
   例如: `xxxx.natfrp.cloud`
3. 输入前端穿透端口（你在前端隧道中设置的远程端口）
4. 输入后端穿透端口（你在后端隧道中设置的远程端口）
5. 确认信息并等待服务启动

## 访问游戏

服务启动后，你和你的朋友可以通过以下地址访问游戏：

```
http://你的樱花域名:前端穿透端口
```

例如:
```
http://xxxx.natfrp.cloud:12345
```

## 故障排除

### 1. CORS错误

如果遇到跨域(CORS)错误:
- 确保两个隧道都正常运行
- 确保在`start-sakura.bat`中输入了正确的域名和端口

### 2. 连接超时

如果连接超时:
- 检查樱花客户端状态是否正常
- 尝试更换节点
- 确认远程端口未被封禁

### 3. WebSocket连接失败

如果多人模式中WebSocket连接失败:
- 尝试将后端隧道类型改为"HTTP"而非"TCP"
- 在樱花客户端设置中启用"WebSocket支持"选项

## 高级配置

### HTTPS支持

如果需要HTTPS支持:
1. 在樱花面板中为域名申请SSL证书
2. 将隧道类型改为HTTPS
3. 修改`start-sakura.bat`中的URL从http改为https

### 自定义域名

如果你有自己的域名:
1. 在域名解析服务商添加CNAME记录指向樱花提供的域名
2. 在樱花面板中添加你的自定义域名
3. 在`start-sakura.bat`中使用你的自定义域名

## 注意事项

- 樱花内网穿透是付费服务，使用可能产生流量费用
- 公网部署有安全风险，请勿长时间部署
- 内网穿透服务的稳定性取决于节点质量，如遇卡顿可尝试更换节点 